<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Snail Game Calculators</title>
    <link rel="icon" type="image/png" href="Eye_of_Horus.png" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Theme Toggle Button -->
    <button class="btn btn-primary btn-icon theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
      <span id="themeIcon">üåô</span>
    </button>

    <!-- Main Calculator Switcher -->
    <div class="calculator-switcher">
      <button id="showGearCalc" class="btn btn-secondary btn-lg switcher-btn active">Gear Calculator</button>
      <button id="showRocketCalc" class="btn btn-secondary btn-lg switcher-btn">Rocket Cabin Calculator</button>
      <button id="showSteleCalc" class="btn btn-secondary btn-lg switcher-btn">Stele Calculator</button>      
      <button id="showCookingCalc" class="btn btn-secondary btn-lg switcher-btn">Cooking Calculator</button>
    </div>

    <!-- ===== GEAR CALCULATOR SECTION ===== -->
<div id="gearCalculator" class="calculator-container">
      <div class="calculator-section">
        <h1>Snail Gear Calculator</h1>
        <div class="info-blurb">
          This calculator helps you plan and optimize your snail and minion gear setups. Use presets to save and load configurations for quick comparisons.
        </div>
        <div class="button-row">
          <button id="resetSnail" class="btn btn-secondary reset-button">Reset</button>
          <div class="preset-group">
            <div class="preset-set">
              <span class="preset-label">Preset 1:</span>
              <button id="saveSnailPreset1" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadSnailPreset1" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
            <div class="preset-set">
              <span class="preset-label">Preset 2:</span>
              <button id="saveSnailPreset2" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadSnailPreset2" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
            <div class="preset-set">
              <span class="preset-label">Preset 3:</span>
              <button id="saveSnailPreset3" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadSnailPreset3" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
          </div>
        </div>
        <div class="snail-label equipped-label">Equipped</div>
        <div class="grid grid-6 gap-md snail-row equipped-row" id="snail-row-1"></div>
        <div class="grid grid-6 gap-md snail-row equipped-row" id="snail-row-2"></div>
        <div class="snail-label unequipped-label">
          Unequipped
          <button id="toggleUnequipped" class="btn btn-xs toggle-section-btn" aria-expanded="true" aria-controls="snail-row-3">‚àí</button>
        </div>
        <div class="grid grid-6 gap-md snail-row unequipped-row" id="snail-row-3"></div>
        <div class="card card-lg totals-column" id="snail-totals">
          <h3>Snail Gear Costs</h3>
          <div id="snailMainTable"></div>
        </div>
      </div>
      <div class="calculator-section">
        <h1>Minion Gear Calculator</h1>
        <div class="button-row">
          <button id="resetMinion" class="btn btn-secondary reset-button">Reset</button>
          <div class="preset-group">
            <div class="preset-set">
              <span class="preset-label">Preset 1:</span>
              <button id="saveMinionPreset1" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadMinionPreset1" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
            <div class="preset-set">
              <span class="preset-label">Preset 2:</span>
              <button id="saveMinionPreset2" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadMinionPreset2" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
            <div class="preset-set">
              <span class="preset-label">Preset 3:</span>
              <button id="saveMinionPreset3" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadMinionPreset3" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
          </div>
        </div>
        <div class="minion-label equipped-label">Equipped</div>
        <div class="grid grid-6 gap-md horizontal-slots equipped-row" id="minion-row-1"></div>
        <div class="minion-label unequipped-label">
          Unequipped
          <button id="toggleMinionUnequipped" class="btn btn-xs toggle-section-btn" aria-expanded="true" aria-controls="minion-row-2">‚àí</button>
        </div>
        <div class="grid grid-6 gap-md horizontal-slots unequipped-row" id="minion-row-2"></div>
        <div class="card card-lg totals-column" id="minion-totals">
          <h3>Minion Gear Costs</h3>
          <div id="minionMainTable"></div>
        </div>
      </div>
    </div>

    <!-- ===== ROCKET CABIN CALCULATOR SECTION (Initially Hidden) ===== -->
<div id="rocketCalculator" class="calculator-container" style="display: none;">
      <div class="calculator-section">
        <h1>Rocket Cabin Upgrade Calculator</h1>
        <div class="info-blurb">
          Select the target tier for each device. You can now choose how material costs are displayed (T1‚ÄìT5) using the dropdown beneath each summary table. All totals will update to your selected tier for easier planning.
        </div>

        <!-- Container for the three cabin grids -->
        <div id="rocket-cabins-container"></div>
      </div>
    </div>

    <!-- ===== STELE LEVEL DISTRIBUTION ANALYSIS SECTION (Initially Hidden) ===== -->
    <div id="steleCalculator" class="calculator-container" style="display: none;">
      <div class="calculator-section">
        <h1>Stele Level Distribution Analysis</h1>
<div class="info-blurb">
          This calculator runs 10,000 simulations to estimate the number of tokens needed to reach a selected Stele level, based on the game's token probabilities. Click a Stele level button below to recalculate for that level.
        </div>

        <div class="d-flex justify-center gap-lg flex-wrap" style="margin-bottom: 30px;">
          <button class="btn btn-secondary stele-level-btn" data-stele="5">Stele 5<br><span class="stele-energy">(1000)</span></button>
          <button class="btn btn-secondary stele-level-btn" data-stele="8">Stele 8<br><span class="stele-energy">(2000)</span></button>
          <button class="btn btn-secondary stele-level-btn" data-stele="10">Stele 10<br><span class="stele-energy">(2900)</span></button>
          <button class="btn btn-secondary stele-level-btn" data-stele="12">Stele 12<br><span class="stele-energy">(4000)</span></button>
          <button class="btn btn-secondary stele-level-btn" data-stele="15">Stele 15<br><span class="stele-energy">(6000)</span></button>
        </div>

        <div class="chart-container">
          <canvas id="distributionChart"></canvas>
        </div>

        <div class="d-flex justify-center gap-lg flex-wrap" style="margin: 24px 0;">
          <div class="stele-prob-item"><span class="stele-prob-label">0 Energy</span><span class="stele-prob-value">53.7%</span></div>
          <div class="stele-prob-item"><span class="stele-prob-label">15 Energy</span><span class="stele-prob-value">33.1%</span></div>
          <div class="stele-prob-item"><span class="stele-prob-label">30 Energy</span><span class="stele-prob-value">7.5%</span></div>
          <div class="stele-prob-item"><span class="stele-prob-label">50 Energy</span><span class="stele-prob-value">5.7%</span></div>
          <div class="stele-prob-item stele-prob-expected"><span class="stele-prob-label">Expected/token</span><span class="stele-prob-value">10.065</span></div>
        </div>

        <!-- Token Probability Feature -->
        <div class="stele-token-prob-container" style="margin: 24px 0 12px 0; text-align: center;">
          <label for="steleTokenInput" style="font-weight: bold; margin-right: 8px;">Check your luck:</label>
          <input type="number" id="steleTokenInput" min="1" style="width: 90px; font-size: 1.1em; margin-right: 8px;" placeholder="Tokens">
          <button id="steleTokenCheckBtn" style="font-size: 1em; padding: 3px 16px;">Check</button>
          <div id="steleTokenProbResult" style="margin-top: 10px; font-size: 1.08em; color: #1a237e;"></div>
        </div>

      </div>
    </div>

    <!-- ===== COOKING CALCULATOR SECTION (Add to index.html, initially hidden) ===== -->
    <div id="cookingCalculator" class="calculator-container" style="display: none;">
      <div class="calculator-section">
        <h1>üç≥ Cooking Profitability Calculator</h1>
        <div class="info-blurb">
          This calculator helps you optimize your cooking strategy based on your available recipes, vendor access, and shop purchases. 
          Configure your recipes and shop options below, and the calculator will show you the most profitable dishes and daily ROI.
        </div>
        
        <!-- Preset Buttons -->
        <div class="button-row">
          <button id="resetCooking" class="btn btn-secondary reset-button">Reset All</button>
          <div class="preset-group">
            <div class="preset-set">
              <span class="preset-label">Preset 1:</span>
              <button id="saveCookingPreset1" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadCookingPreset1" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
            <div class="preset-set">
              <span class="preset-label">Preset 2:</span>
              <button id="saveCookingPreset2" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadCookingPreset2" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
            <div class="preset-set">
              <span class="preset-label">Preset 3:</span>
              <button id="saveCookingPreset3" class="btn btn-secondary btn-sm preset-button">Save</button>
              <button id="loadCookingPreset3" class="btn btn-secondary btn-sm preset-button">Load</button>
            </div>
          </div>
        </div>
        
        <!-- Export/Import Configuration Row -->
        <div class="d-flex justify-center gap-md" style="margin: 15px 0;">
          <button id="exportCookingConfig" class="btn btn-primary">üì§ Export Configuration</button>
          <button id="importCookingConfig" class="btn btn-primary">üì• Import Configuration</button>
        </div>
        
        <!-- Vendor Configuration Section -->
        <div class="cooking-section">
          <div class="d-flex items-center gap-sm" style="margin-bottom: 15px;">
            <h3 style="margin: 0;">üé™ Vendor Configuration</h3>
          </div>
          <div id="cooking-vendor-config"></div>
        </div>
        
        <!-- Shop Purchases Section -->
        <div class="cooking-section">
          <div class="d-flex items-center gap-sm" style="margin-bottom: 15px;">
            <h3 style="margin: 0;">üõí Daily Shop Purchases</h3>
          </div>
          <div id="cooking-shop-config"></div>
        </div>
        
        <!-- Recipe Manager Section -->
        <div class="cooking-section">
          <div class="d-flex items-center gap-sm" style="margin-bottom: 15px;">
            <h3 style="margin: 0;">üìñ Recipes</h3>
            <span style="font-size: 0.85em; color: #666;">Enable/disable recipes and set your current stars & sell price</span>
          </div>
          <div id="cooking-recipe-manager"></div>
        </div>
        
        <!-- Results Dashboard Section -->
        <div id="cooking-results"></div>
        
      </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal-overlay" style="display: none;">
      <div class="modal-dialog">
        <div class="d-flex justify-between items-center p-sm" style="background: var(--bg-highlight); border-bottom: 2px solid var(--bg-highlight);">
          <h3 style="margin: 0;">üì§ Export Configuration</h3>
          <button class="modal-close" onclick="closeCookingModal()">&times;</button>
        </div>
        <div class="modal-body">
          <p style="margin-bottom: 12px; color: #666;">Copy this string and save it somewhere safe. You can use it to restore your configuration or share it with others.</p>
          <textarea id="exportTextarea" readonly style="width: 100%; height: 150px; font-family: monospace; font-size: 0.9em; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;"></textarea>
        </div>
        <div class="d-flex justify-end gap-sm p-sm" style="border-top: 1px solid var(--bg-highlight);">
          <button id="copyExportBtn" class="btn btn-primary">üìã Copy to Clipboard</button>
          <button onclick="closeCookingModal()" class="btn btn-secondary">Close</button>
        </div>
      </div>
    </div>

    <!-- Import Modal -->
    <div id="importModal" class="modal-overlay" style="display: none;">
      <div class="modal-dialog">
        <div class="d-flex justify-between items-center p-sm" style="background: var(--bg-highlight); border-bottom: 2px solid var(--bg-highlight);">
          <h3 style="margin: 0;">üì• Import Configuration</h3>
          <button class="modal-close" onclick="closeCookingModal()">&times;</button>
        </div>
        <div class="modal-body">
          <p style="margin-bottom: 12px; color: #666;">Paste your configuration string below to restore a saved setup.</p>
          <textarea id="importTextarea" placeholder="Paste configuration string here..." style="width: 100%; height: 150px; font-family: monospace; font-size: 0.9em; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;"></textarea>
          <div id="importError" style="display: none; margin-top: 10px; padding: 10px; background: #ffebee; border: 1px solid #ef5350; border-radius: 4px; color: #c62828;"></div>
        </div>
        <div class="d-flex justify-end gap-sm p-sm" style="border-top: 1px solid var(--bg-highlight);">
          <button id="doImportBtn" class="btn btn-primary">‚úÖ Import</button>
          <button onclick="closeCookingModal()" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
    </div>

    <script src="data.js"></script>
    <script src="script.js"></script>
    <script src="cooking-data.js"></script>
    <script src="cooking.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script type="module" src="stele.js"></script>
    <script data-goatcounter="https://snailcalc.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
  </body>
</html>
